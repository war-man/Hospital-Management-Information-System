@model IEnumerable<CaresoftHMISDataAccess.Patient>
<table class="table table-data table-hover table-condensed">
    <tr>
        <th>
            Edit
        </th>
        <th>Registration</th>
        <th>
            @Html.DisplayNameFor(model => model.RegNumber)
        </th>
        @*<th>
                @Html.DisplayNameFor(model => model.MainCategory)
            </th>*@

        <th>
            @Html.DisplayNameFor(model => model.Salutation)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.FName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.MName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.LName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Gender)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.DOB)
        </th>
        <th>
            Age
        </th>

        <th>
            Mobile
        </th>

        <th>
            @Html.DisplayNameFor(model => model.HomeAddress)
        </th>

        <th>
            @Html.DisplayNameFor(model => model.NationalId)
        </th>

        <th>
            @Html.DisplayNameFor(model => model.Email)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.BloodGroup)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Religion)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.MaritalStatus)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.RegDate)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.RegTime)
        </th>


    </tr>


    <tbody class="bg-white">
        @foreach (var item in Model.OrderByDescending(e => e.Id))
        {
        <tr data-patient-id="@item.Id">
            <td>
                @Html.ActionLink("Edit", "Edit", new { id = item.Id })
            </td>
            <td>
                <button class="call-modal-form btn btn-xs btn-primary btnHivRegistration"
                        data-action="@Url.Action("InvestigationForm", "EMR", new { id= item.Id, idType = "PatientId" })"
                        data-callback="investigationModalListener" 
                        data-patient-id="@item.Id">
                                              
                        
                    New HIV Registration
                </button>


            </td>

            <td>
                @Html.DisplayFor(modelItem => item.RegNumber)
            </td>
            @*<td>
            @Html.DisplayFor(modelItem => item.MainCategory)
        </td>*@

            <td>
                @Html.DisplayFor(modelItem => item.Salutation)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.FName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.LName)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Gender)
            </td>
            <td>
                @if (item.DOB != null)
                {
                    @item.DOB.Value.ToString("dd MMM yyyy")
                }
            </td>
            <td>
                @if (item.DOB != null)
                {
                    var age = DateTime.Now.Year - item.DOB.Value.Year;
                    var unit = "Y";
                    if (age.Equals(0))
                    {
                        age = DateTime.Now.Month - item.DOB.Value.Month;
                        unit = "M";
                    }
                    if (age.Equals(0))
                    {
                        age = DateTime.Now.Day - item.DOB.Value.Day;
                        unit = "D";
                    }


                    @age<text><small> @unit</small></text>
                }
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.Mobile)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.HomeAddress)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.NationalId)
            </td>

            <td>
                @Html.DisplayFor(modelItem => item.Email)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.BloodGroup)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.Religion)
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.MaritalStatus)
            </td>
            <td>
                @if (item.RegDate != null)
                {
                    @item.RegDate.Value.ToString("dd MMM yyyy")
                }
            </td>
            <td>
                @Html.DisplayFor(modelItem => item.RegTime)
            </td>


        </tr>
        }
    </tbody>

</table>